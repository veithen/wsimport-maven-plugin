dist: trusty
language: java
jdk:
  - openjdk8
  - openjdk9
  - openjdk10
  - openjdk11
before_install:
  - if [ -e $JAVA_HOME/lib/security/cacerts ]; then ln -sf /etc/ssl/certs/java/cacerts $JAVA_HOME/lib/security/cacerts; fi
install: true
script: mvn -B -s .travis-settings.xml -Prelease -Dgpg.skip=true verify
before_cache: "find $HOME/.m2 -name '*-SNAPSHOT' -a -type d -print0 | xargs -0 rm -rf"
jobs:
  include:
    - if: repo = "veithen/wsimport-maven-plugin" AND branch = master AND type = push
      stage: deploy
      script: mvn -B -s .travis-settings.xml -Prelease -Dgpg.skip=true -DskipTests=true deploy
      env:
        - secure: "fLbbfCrCI7VSmBySMdCAKSKn67R1uFFx0a2wXfnPM5XcRg1ujxrZG9qTK4RSj9IxnxwfzKYdR0TDY8o93WD1ML7I8+LfWMxukDFRdJ33UKMV/MXrwwgCj2HHt2nc7DbJfyG6OSD3uajI6ppLHrsfoNT6Ou/p5/yVMMuiRUNUVwe5JAuShgZ5ZY16k5fkieUG6Ar9h66kbcBqIpDebYYxsAMuUlUOpQFm8TEa54gM5PeeQEYMGCHyKoa5Njlrqh1vg8lgu6biBQ1Y3IVBiBjpZeXu/UiKWSDHV9AWKw++ONc2c6X2cMBEmgL1zgQGoolw9YrbzMQpC2FiUh18zYWKYvoeD5DrZU05VBaKMEVjsKXsn1ZWninJjN5p8f2CAb/2aZZHmBu5466DfO4so+c4dk1makm5XNXpLIXsMtCS3rMHk1h4w0oeZxKBZ2q6qQIoTluU5+DMZd5nG8lSoY3QdpVeWW6k6fF9jceyfkcRustSYr+aJv14FupvH8MPfMg75TiBDRII//WON2l/O0E5YKocxUaBdjZMBNdaJlvFaFWbDskiclWy4R+/LVIEN7FsLMDmHiXvRawlUKU/EWhU24vwmZ/UMczOI3SUJGSJTVrFjSGTb0gyB7RUmfrnNEBfJ9N4yDfZ9RoLljLDHU4H88KwAvWEdLU8qoIYBSRfhkw="
cache:
  directories:
    - $HOME/.m2
